import{b as z,H as _,p as B,W as G,I as c,J as U,F as j,a as M}from"./index.ac02f68f.js";import{S as W,d as O}from"./index.399f9528.js";import{e as q}from"./vue.5bd64dc7.js";import{l as A,r as m,H as b,cs as i,bm as e,j as s,t as D,av as V,w as F,$ as Y,q as J}from"./bundle.f4813fa2.js";import{C as S}from"./utils.293bb65e.js";import{u as K}from"./erc20.e9c36ea3.js";import{g as I}from"./etherscan.83df9912.js";import{f as k}from"./numberFormat.980bf1e6.js";import{C as N}from"./crowdfunding.247a539a.js";import"./ui.e26017cf.js";import"./tools.becc2b88.js";import"./ethers.043ad920.js";import"./wallet.eb251e2a.js";import"./inherits.303311a2.js";const $=A({name:"CrowdfundingCard",props:{info:{type:Object,required:!0},onClick:{type:Function}},setup(t,f){const v=z().chainId,g=m(),u=m(),x=K(),o=m({raiseAmount:0,raiseGoal:0,raisePercent:0,swapAmount:0}),w=b(()=>{var l;return(l=I(t.info.chain_id))==null?void 0:l.logo}),C=async()=>{o.value.raiseGoal=Number(k(Number(t.info.raise_goal),8)),o.value.raiseAmount=Number(k(Number(t.info.raise_balance),8)),o.value.raisePercent=Number(k(o.value.raiseAmount/o.value.raiseGoal*100,4)),o.value.swapAmount=Number(t.info.swap_percent)},y=b(()=>t.info.invest_token_contract==="0x0000000000000000000000000000000000000000"),d=async()=>{var l;if(t.info.chain_id==v){const h=await x(t.info.presale_token_contract);if(g.value=await h.symbol(),y.value)u.value=(l=I(t.info.chain_id))==null?void 0:l.currencySymbol;else{const r=await x(t.info.invest_token_contract);u.value=await r.symbol()}}else g.value=t.info.presale_token_symbol,u.value=t.info.invest_token_symbol},p=b(()=>t.info.status===S.CANCELED?"Cancelled":i().isAfter(+t.info.end_time)||t.info.status===S.ENDED?"Ended":i.utc().isBefore(i(+t.info.start_time).utc())?"Upcoming":"Live"),a=b(()=>{if(t.info.status===S.CANCELED)return e("div",{class:"text-color3"},[s("Cancelled")]);if(i().isAfter(+t.info.end_time))return e("div",{class:"text-color3"},[s("Ended")]);let l;if(i.utc().isBefore(i(+t.info.start_time).utc())){l=i.duration(i(+t.info.start_time).diff(i.utc().utc()));const T=Math.floor(l.asDays()),[H,R,P]=i.duration(i(+t.info.start_time).diff(i.utc().utc())).format("HH-mm-ss").split("-");return e("div",{class:"flex items-center"},[e("span",{class:"flex-1"},[s("Starts In\uFF1A")]),e("span",{class:"text-primary"},[T,s(":"),H,s(":"),R,s(":"),P])])}l=i.duration(i(+t.info.end_time).utc().diff(i.utc()));const h=Math.floor(l.asDays()),[r,E,L]=l.format("HH-mm-ss").split("-");return e("div",{class:"flex items-center"},[e("span",{class:"flex-1"},[s("Ends In\uFF1A")]),e("span",{class:"text-primary"},[h,s(":"),r,s(":"),E,s(":"),L])])});return D(()=>{d(),C()}),()=>e("div",{class:"bg-white border border-color-border rounded-sm cursor-pointer  top-0 overflow-hidden relative hover:bg-color-hover",style:"transition:all ease .3s",onClick:()=>{var l;return(l=t.onClick)==null?void 0:l.call(t)}},[e(_,{type:"filled",bgColor:"#fff",class:"border top-4 right-4 absolute !border-color-border !text-color2"},{default:()=>[p.value]}),e(B,{src:t.info.poster,class:" h-10.75rem w-full"},null),e("div",{class:"p-6"},[e("div",{class:"flex mb-2 items-center"},[e("span",{class:"flex-1 mr-4 text-color1 truncate u-h3",title:t.info.startup.name},[t.info.title]),e("img",{class:"w-[22px] h-[22]px",src:w.value},null)]),e("div",{class:"flex mb-2"},[e("div",{class:"flex-1 text-0.75rem"},[e("div",{class:"text-grey3  leading-6"},[s("Raise Goal ")]),e("div",{class:"text-primary"},[e("span",{class:"mr-1 u-h3"},[o.value.raiseGoal]),e("span",{class:"u-h7"},[u.value])])]),t.info.kyc&&e(_,{class:"mr-1 "},{default:()=>[s("KYC")]}),t.info.contract_audit&&e(_,null,{default:()=>[s("AUDIT")]})]),e(G,{showIndicator:!1,percentage:o.value.raisePercent,color:"#00BFA5",height:6,class:"mb-2"},null),e("div",{class:"flex mb-2 items-center"},[e("div",{class:"flex-1 u-h7"},[e("span",{class:"text-color1"},[o.value.raiseAmount]),e("span",{class:"ml-1 text-color3"},[u.value])]),e("div",{class:"text-right text-color1 u-num2"},[o.value.raisePercent,s(" %")])]),e("div",{class:"flex mt-3 justify-between u-h6"},[e("span",{class:"text-color3"},[s("Rate:")]),e("span",{class:"text-right text-color1"},[s("1 "),u.value,s(" = "),t.info.buy_price,s(" "),g.value])]),e("div",{class:"flex mt-2 justify-between "},[e("span",{class:"text-color3"},[s("Swap %:")]),e("span",{class:"text-right text-color1"},[t.info.swap_percent,s(" %")])])]),e("div",{class:"border-[#F5F6FA] border-t-1 py-3 px-6 text-color3 u-h6"},[a.value])])}}),Q=A({name:"CrowdfundingSkeleton",setup(t){return()=>e("div",{class:"bg-white rounded-sm h-108 relative"},[e("div",{class:"p-4"},[e(c,{class:" rounded mb-8",height:"10rem"},null),e("div",{class:"flex mb-4"},[e("div",{class:"flex-1"},[e(c,{height:"1.25rem"},null)]),e(c,{class:" ml-4",width:"1.5rem",height:"1.25rem"},null)]),e("div",{class:"flex mb-4"},[e("div",{class:"flex-1"},[e(c,{width:"6.75rem",height:"3.375rem"},null)]),e(c,{class:"ml-2",height:"1.25rem",width:"3.375rem"},null),e(c,{class:"ml-2",height:"1.25rem",width:"3.375rem"},null)]),e(c,{class:" mb-1rem",height:"1.25rem"},null),e(c,{class:" mb-1rem",height:"1.25rem"},null),e(c,{class:" mb-1rem",height:"1.25rem"},null)])])}}),me=A({name:"CrowdfundingList",setup(){const t=m(void 0),f=m(""),n=V({pageSize:24,total:0,page:1,loading:!1}),v=m([]),g=async a=>{const l=N.indexOf(t.value),{error:h,data:r}=await M["Crowdfunding@get-crowdfunding"]({page:n.page,size:n.pageSize,status:l>-1?l:void 0,keyword:f.value});h||(a?v.value=(r==null?void 0:r.list)||[]:v.value.push(...(r==null?void 0:r.list)||[]),n.total=r.total||0)},u=q(),x=a=>{u.push("/launchpad/"+a)},o=async(a,l)=>{n.loading=!0,n.page=a,await g(l),n.loading=!1},w=O(o);F(()=>t.value,()=>w(1,!0)),F(()=>f.value,()=>w(1,!0));const C=b(()=>(n.page||0)*(n.pageSize||0)>=(n.total||0));let y=0,d=document.body;const p=()=>{if(!n.loading){const a=d==null?void 0:d.getBoundingClientRect();a.height+a.top-y<240&&(C.value||(n.page++,o(n.page)))}};return D(()=>{Y(()=>{y=window.innerHeight,d=document.body,document.addEventListener("scroll",p),o(n.page)})}),J(()=>{document.removeEventListener("scroll",p)}),()=>e(j,{show:n.loading},{default:()=>[e("div",{class:"flex mb-3 items-center"},[e("div",{class:"flex-1"},null),e(U,{options:N.filter(a=>!["Pending","Failure"].includes(a)).map(a=>({label:a,value:a})),placeholder:"Filter",class:"rounded mr-4 w-28",clearable:!0,value:t.value,"onUpdate:value":a=>t.value=a},null),e(W,{value:f.value,"onUpdate:value":a=>f.value=a,placeholder:"Search",loading:n.loading},null)]),e("div",{class:"grid pb-6 gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 "},[v.value.map(a=>e($,{key:a.id,info:a,onClick:()=>x(a.id)},null)),n.loading&&new Array(n.pageSize).fill("").map(a=>e(Q,null,null))])]})}});export{me as default};
