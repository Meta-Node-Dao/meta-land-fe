import{a as u,h as l}from"./index.ac02f68f.js";import{e as d,u as f}from"./vue.5bd64dc7.js";import{r as h,t as m}from"./bundle.f4813fa2.js";import{a as p}from"./auth.dad759c7.js";import"./useTags.f9c969ef.js";function L(c,a){const{push:n}=d(),{query:e}=f(),s=h();return m(async()=>{var r;if(e.code&&e.state)if(((r=e.state.match(/^u([01])/))==null?void 0:r[1])==="0"&&!window.location.origin.match(/http:\/\/localhost/))window.location.href=`http://localhost:9001/auth/callback/${c}?code=${e.code}&state=${e.state}`;else{let t;if(typeof a=="function")t=await a(e.code);else{const i=e.state.includes("u")?void 0:e.state,o=await u[a]({code:e.code,state:e.state,skipMessage:!0,invitation_code:i});if(!o.error)t=o.data;else if(o.error&&o.code===400){l.error("The social account has been connected"),n("/auth/association?type=account");return}}t?p(t):s.value="Error when get user"}else s.value="Invalid url"}),s}export{L as u};
