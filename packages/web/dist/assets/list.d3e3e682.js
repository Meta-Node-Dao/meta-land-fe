import{b as R,H as z,p as B,W as M,I as c,J as j,F as U,a as q}from"./index.ac02f68f.js";import{S as G,d as W}from"./index.399f9528.js";import{e as O}from"./vue.5bd64dc7.js";import{l as S,r as f,H as g,cs as o,bm as e,j as n,t as I,av as V,w as k,$ as J,q as Y}from"./bundle.f4813fa2.js";import{S as F}from"./utils.f10e23c9.js";import{u as $}from"./erc20.e9c36ea3.js";import{g as A}from"./etherscan.83df9912.js";import{f as C}from"./numberFormat.980bf1e6.js";import{C as L}from"./crowdfunding.247a539a.js";import"./ui.e26017cf.js";import"./tools.becc2b88.js";import"./ethers.043ad920.js";import"./wallet.eb251e2a.js";import"./inherits.303311a2.js";const K=S({name:"CrowdfundingCard",props:{info:{type:Object,required:!0},onClick:{type:Function}},setup(t,m){const v=R().chainId,b=f(),u=f(),x=$(),i=f({raiseAmount:0,raiseGoal:0,raisePercent:0}),y=g(()=>{var s;return(s=A(t.info.chain_id))==null?void 0:s.logo}),p=async()=>{i.value.raiseGoal=Number(C(Number(t.info.soft_cap),8)),i.value.raiseAmount=Number(C(Number(t.info.invest_token_balance),8)),i.value.raisePercent=Math.round(Number(C(i.value.raiseAmount/i.value.raiseGoal*100,4)))},w=g(()=>t.info.invest_token_contract==="0x0000000000000000000000000000000000000000"),d=async()=>{var s;if(t.info.chain_id==v){const h=await x(t.info.presale_token_contract);if(b.value=await h.symbol(),w.value)u.value=(s=A(t.info.chain_id))==null?void 0:s.currencySymbol;else{const r=await x(t.info.invest_token_contract);u.value=await r.symbol()}}else b.value=t.info.presale_token_symbol,u.value=t.info.invest_token_symbol},_=g(()=>t.info.status===F.CANCELED?"Cancelled":o().isAfter(+t.info.ended_at*1e3)?"Ended":o.utc().isBefore(o(+t.info.started_at*1e3).utc())?"Upcoming":"Live"),a=g(()=>{if(t.info.status===F.CANCELED)return e("div",{class:"text-color3"},[n("Cancelled")]);if(o().isAfter(+t.info.ended_at*1e3))return e("div",{class:"text-color3"},[n("Ended")]);let s;if(o.utc().isBefore(o(+t.info.started_at*1e3).utc())){s=o.duration(o(+t.info.started_at*1e3).diff(o.utc().utc()));const D=Math.floor(s.asDays()),[H,T,P]=o.duration(o(+t.info.started_at*1e3).diff(o.utc().utc())).format("HH-mm-ss").split("-");return e("div",{class:"flex items-center"},[e("span",{class:"flex-1"},[n("Starts In\uFF1A")]),e("span",{class:"text-primary"},[D,n(":"),H,n(":"),T,n(":"),P])])}s=o.duration(o(+t.info.ended_at*1e3).utc().diff(o.utc()));const h=Math.floor(s.asDays()),[r,N,E]=s.format("HH-mm-ss").split("-");return e("div",{class:"flex items-center"},[e("span",{class:"flex-1"},[n("Ends In\uFF1A")]),e("span",{class:"text-primary"},[h,n(":"),r,n(":"),N,n(":"),E])])});return I(()=>{d(),p()}),()=>e("div",{class:"bg-white border border-color-border rounded-sm cursor-pointer  top-0 overflow-hidden relative hover:bg-color-hover",style:"transition:all ease .3s",onClick:()=>{var s;return(s=t.onClick)==null?void 0:s.call(t)}},[e(z,{type:"filled",bgColor:"#fff",class:"border top-4 right-4 absolute !border-color-border !text-color2"},{default:()=>[_.value]}),e(B,{src:t.info.poster,class:" h-10.75rem w-full"},null),e("div",{class:"p-6"},[e("div",{class:"flex mb-2 items-center"},[e("span",{class:"flex-1 mr-4 text-color1 truncate u-h3",title:t.info.title},[t.info.title]),e("img",{class:"w-[22px]",src:y.value},null)]),e("div",{class:"flex mb-2"},[e("div",{class:"flex-1 text-0.75rem"},[e("div",{class:"text-grey3  leading-6"},[n("Soft/Hard")]),e("div",{class:"text-primary"},[e("span",{class:"mr-1 u-h3"},[t.info.soft_cap,t.info.invest_token_symbol]),n("-"),e("span",{class:"u-h3"},[t.info.hard_cap,t.info.invest_token_symbol])])])]),e(M,{showIndicator:!1,percentage:i.value.raisePercent,color:"#00BFA5",height:6,class:"mb-2"},null),e("div",{class:"flex mb-2 items-center"},[e("div",{class:"flex-1 u-h7"},[e("span",{class:"text-color1"},[i.value.raiseAmount]),e("span",{class:"ml-1 text-color3"},[u.value])]),e("div",{class:"text-right text-color1 u-num2"},[i.value.raisePercent,n(" %")])]),e("div",{class:"flex mt-3 justify-between u-h6"},[e("span",{class:"text-color3"},[n("Rate:")]),e("span",{class:"text-right text-color1"},[n("1 "),u.value,n(" = "),t.info.presale_price," ",t.info.presale_token_symbol])]),e("div",{class:"flex mt-2 justify-between "},[e("span",{class:"text-color3"},[n("Liquidity %:")]),e("span",{class:"text-right text-color1"},[t.info.liquidity_rate*100])])]),e("div",{class:"border-[#F5F6FA] border-t-1 py-3 px-6 text-color3 u-h6"},[a.value])])}}),Q=S({name:"CrowdfundingSkeleton",setup(t){return()=>e("div",{class:"bg-white rounded-sm h-108 relative"},[e("div",{class:"p-4"},[e(c,{class:" rounded mb-8",height:"10rem"},null),e("div",{class:"flex mb-4"},[e("div",{class:"flex-1"},[e(c,{height:"1.25rem"},null)]),e(c,{class:" ml-4",width:"1.5rem",height:"1.25rem"},null)]),e("div",{class:"flex mb-4"},[e("div",{class:"flex-1"},[e(c,{width:"6.75rem",height:"3.375rem"},null)]),e(c,{class:"ml-2",height:"1.25rem",width:"3.375rem"},null),e(c,{class:"ml-2",height:"1.25rem",width:"3.375rem"},null)]),e(c,{class:" mb-1rem",height:"1.25rem"},null),e(c,{class:" mb-1rem",height:"1.25rem"},null),e(c,{class:" mb-1rem",height:"1.25rem"},null)])])}}),fe=S({name:"CrowdfundingList",setup(){const t=f(void 0),m=f(""),l=V({pageSize:24,total:0,page:1,loading:!1}),v=f([]),b=async a=>{const s=L.indexOf(t.value),{error:h,data:r}=await q["SaleLaunchpad@get-sale-launchpad"]({page:l.page,size:l.pageSize,status:s>-1?s:void 0,keyword:m.value});h||(a?v.value=(r==null?void 0:r.list)||[]:v.value.push(...(r==null?void 0:r.list)||[]),l.total=r.total||0)},u=O(),x=a=>{u.push("/sale-launchpad/"+a)},i=async(a,s)=>{l.loading=!0,l.page=a,await b(s),l.loading=!1},y=W(i);k(()=>t.value,()=>y(1,!0)),k(()=>m.value,()=>y(1,!0));const p=g(()=>(l.page||0)*(l.pageSize||0)>=(l.total||0));let w=0,d=document.body;const _=()=>{if(!l.loading){const a=d==null?void 0:d.getBoundingClientRect();a.height+a.top-w<240&&(p.value||(l.page++,i(l.page)))}};return I(()=>{J(()=>{w=window.innerHeight,d=document.body,document.addEventListener("scroll",_),i(l.page)})}),Y(()=>{document.removeEventListener("scroll",_)}),()=>e(U,{show:l.loading},{default:()=>[e("div",{class:"flex mb-3 items-center"},[e("div",{class:"flex-1"},null),e(j,{options:L.filter(a=>!["Pending","Failure"].includes(a)).map(a=>({label:a,value:a})),placeholder:"Filter",class:"rounded mr-4 w-28",clearable:!0,value:t.value,"onUpdate:value":a=>t.value=a},null),e(G,{value:m.value,"onUpdate:value":a=>m.value=a,placeholder:"Search",loading:l.loading},null)]),e("div",{class:"grid pb-6 gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 "},[v.value.map(a=>e(K,{key:a.id,info:a,onClick:()=>x(a.id)},null)),l.loading&&new Array(l.pageSize).fill("").map(a=>e(Q,null,null))])]})}});export{fe as default};
