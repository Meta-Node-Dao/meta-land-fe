import{d as C,X as I,k as T,h as O}from"./index.ac02f68f.js";import{r as X,u as L}from"./useShare.dac42af0.js";import{r as G}from"./Twitter.88072fb4.js";import{l as F,r as b,bm as u}from"./bundle.f4813fa2.js";import"./tools.becc2b88.js";import"./useTags.f9c969ef.js";const H="/assets/banner_default.f97d0be7.jpg",M="data:image/png;base64,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",y=(e,A,t,o,n,r,s,m=!1)=>{n<2*s&&(s=n/2),r<2*s&&(s=r/2),e.save(),e.beginPath(),e.moveTo(t+s,o),e.arcTo(t+n,o,t+n,o+r,s),e.arcTo(t+n,o+r,t,o+r,s),e.arcTo(t,o+r,t,o,s),e.arcTo(t,o,t+n,o,s),e.closePath(),e.fillStyle="rgba(255,255,255,0)",e.fill(),e.clip(),e.drawImage(A,t,o,n,r),e.restore()},P=F({name:"GenerateShareImage",setup(e,{expose:A}){const t=b();return A({generate:n=>{console.warn("generate",n);const r=n.infos||n.content?280:380;return new Promise((s,m)=>{if(t.value){const l=t.value.getContext("2d");if(n.title){const w=function(){console.log("ready to draw banner");const a=t.value.width/t.value.height;let d=0,f=0,i,c;g.width/g.height<a?(i=g.width,d=0,c=i/a,f=(g.height-c)/2):(c=g.height,f=0,i=c*a,d=(g.width-i)/2),l.drawImage(g,d,f,i,c,0,0,t.value.width,t.value.height);const h=l.createLinearGradient(0,t.value.height/3,0,t.value.height);h.addColorStop(0,"rgba(0,0,0,0)"),h.addColorStop(1,"rgba(0,0,0,0.9)"),l.fillStyle=h,l.fillRect(0,t.value.height/3,t.value.width,t.value.height)},S=function(){if(l.save(),Array.isArray(n.infos)&&n.infos.length){let d=0;const f=40;n.infos.forEach((i,c)=>{l.fillStyle="white",l.font="bold 40px Outfit,sans-serif";let h=l.measureText(i.count).width;l.fillText(i.count,60+d+c*f,450),i.unit&&(l.font="28px Outfit,sans-serif",l.fillText(` ${i.unit}`,60+d+c*f+h,450),h+=l.measureText(` ${i.unit}`).width),l.fillStyle="rgba(255,255,255,0.6)",l.font="bold 28px Outfit,sans-serif",h=Math.max(h,l.measureText(i.label).width),l.fillText(i.label,60+d+c*f,490),d+=h})}else if(n.content){l.fillStyle="white",l.font="28px Outfit,sans-serif";const a=Math.floor((t.value.width-120)/28),d=a<n.content.length?n.content.substring(0,a)+"...":n.content;l.fillText(d,60,450)}l.restore()},Y=function(){l.fillStyle="white",l.font="bold 44px Outfit,sans-serif",l.fillText(n.title,180,r+60)},v=function(){t.value.toBlob(a=>{const d=new File([a],`generate-${new Date().getTime()}.jpg`);s(d)},"image/jpeg")},g=new Image;g.crossOrigin="Anonymous",g.onload=()=>{w();const a=new Image;a.crossOrigin="Anonymous",a.onload=()=>{y(l,a,60,r,96,96,4,n.noShadow),S(),Y(),v()},g.onerror=()=>{m(new Error("logoLoaded load error"))},a.src=n.logoUrl?`${n.logoUrl}?_t=${new Date().getTime()}`:M},g.onerror=()=>{m(new Error("bannerImg load error"))},g.src=n.imageUrl?`${n.imageUrl}?_t=${new Date().getTime()}`:H}else m(new Error("missing params title"))}else m(new Error("canvas dom unset"))})}}),{domRef:t}},render(){return u("div",{style:"position:absolute;left:-9999em;top:-9999em;z-index:-1"},[u("canvas",{ref:e=>this.domRef=e,width:1008,height:528,style:"width: 504px;height: 264px;"},null)])}}),x="rounded-full cursor-pointer bg-[#F0F0F0] h-6 text-center leading-7 w-6 hover:text-primary hover:bg-white hover:shadow",E=F({name:"ShareButtonGroup",props:{generate:{type:Object,required:!0},route:{type:String,required:!0},title:{type:String,required:!0},description:{type:String,required:!0},text:{type:String},tags:{type:String},copyText:{type:String},tipPlacement:{type:String,default:"left"}},setup(e){const A=C(),t=b(),{onUpload:o}=I(),{shareToTwitter:n,copyText:r}=L();return{GenerateRef:t,handleShareToTwitter:()=>{t.value?t.value.generate({imageUrl:e.generate.banner,logoUrl:e.generate.logo,title:e.generate.name,infos:e.generate.infos,content:e.generate.content}).then(l=>{console.log("got imageFile",l);let w=e.route;location.host.indexOf("127.0.0.1")!==-1&&w.indexOf(location.host)!==-1&&(w=w.replace(location.host,"gorollux.com")),o(l,()=>null).then(S=>{S&&n({image:S,route:w,title:e.title,description:e.description,text:e.text,tags:e.tags})})}):console.warn("GenerateRef is unset!")},handleCopy:()=>{r({text:e.copyText||e.text+window.location.href})&&O.success("Successfully copy.")},globalConfigStore:A}},render(){return u("div",{class:"flex flex-col px-4 text-color2 gap-2 <lg:flex-row <lg:px-0"},[u(T,{show:this.globalConfigStore.isLargeScreen?void 0:!1,placement:this.tipPlacement},{trigger:()=>u("div",{class:x,onClick:this.handleShareToTwitter},[u(G,null,null)]),default:()=>"Share to Twitter"}),u(P,{ref:e=>this.GenerateRef=e},null),u(T,{show:this.globalConfigStore.isLargeScreen?void 0:!1,placement:this.tipPlacement},{trigger:()=>u("div",{class:x,onClick:this.handleCopy},[u(X,null,null)]),default:()=>"Copy Link"}),this.$slots.default?this.$slots.default():null])}});export{E as S,x as a};
