import{J as h,F as f,a as L}from"./index.ac02f68f.js";import{S as w,d as S}from"./index.399f9528.js";import{P as y}from"./ProposalCard.a5d09060.js";import{l as b,r as u,av as E,w as P,H as z,t as D,$ as I,q as x,bm as o}from"./bundle.f4813fa2.js";import"./vue.5bd64dc7.js";import"./ui.e26017cf.js";import"./tools.becc2b88.js";import"./ethers.043ad920.js";import"./wallet.eb251e2a.js";import"./inherits.303311a2.js";import"./Confirm.fc9e96f5.js";import"./index.50b02406.js";const A=["Upcoming","Active","Ended","Invalid"],q=b({name:"GovernanceListPage",setup(){const e=u(void 0),n=u(""),i=u([]),a=E({pageSize:10,total:0,page:1,loading:!1}),g=async t=>{try{const{error:s,data:r}=await L["Proposal@get-proposal"]({page:a.page,size:a.pageSize,keyword:n.value,status:e.value!==void 0&&e.value!==null?e.value+1:void 0});s||(t?i.value=r.list||[]:i.value.push(...r.list||[]),a.total=r==null?void 0:r.total)}catch(s){console.error(s)}},p=async(t,s)=>{a.loading=!0,a.page=t,await g(s),a.loading=!1},m=S(p);P(()=>[e.value,n.value],()=>m(1,!0));const v=z(()=>(a.page||0)*(a.pageSize||0)>=(a.total||0));let d=0,l=document.body;const c=()=>{if(!a.loading){const t=l==null?void 0:l.getBoundingClientRect();t.height+t.top-d<240&&(v.value?document.removeEventListener("scroll",c):(a.page++,p(a.page)))}};return D(()=>{I(()=>{d=window.innerHeight,l=document.body,document.addEventListener("scroll",c),p(a.page)})}),x(()=>{document.removeEventListener("scroll",c)}),{DataList:i,proposalStatus:e,pagination:a,searchInput:n}},render(){return o(f,{show:this.pagination.loading},{default:()=>[o("div",{class:"flex mb-3"},[o("div",{class:"flex-1"},null),o(h,{options:A.map((e,n)=>({label:e,value:n})),placeholder:"Filter",class:"rounded w-28",clearable:!0,value:this.proposalStatus,"onUpdate:value":e=>this.proposalStatus=e},null),o(w,{value:this.searchInput,"onUpdate:value":e=>this.searchInput=e,placeholder:"Search",loading:this.pagination.loading},null)]),Array.isArray(this.DataList)&&this.DataList.map(e=>o(y,{key:e.id,proposalData:e},null))]})}});export{q as default};
