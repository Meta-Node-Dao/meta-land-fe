import{z as ne,S as J,B as z,D as O,l as xe,q as de,e as H,U as Te,P as Ce,b as K,c as pe,L as De,x as ie,m as Pe,v as Ue,_ as N,a as X,V as me,h as Q,i as Be}from"./index.ac02f68f.js";import{r as Fe}from"./Period.d7f0205f.js";import{r as Ne}from"./Stage.c11ca763.js";import{bD as ye,bf as fe,bg as he,l as j,r as S,bm as t,M as F,j as r,H as R,w as Re,F as je,cs as W,av as Oe}from"./bundle.f4813fa2.js";import{e as Me}from"./vue.5bd64dc7.js";import{M as f,a as te,A as C,u as ue,B as Ae,b as Ee}from"./bountyFactory.4905ecc7.js";import{R as Le}from"./index.160e8328.js";import{B as G,P as Ve}from"./bounty.b5687463.js";import{r as $e,a as qe}from"./MinusCircle.5e3a505f.js";import{p as q}from"./ethers.043ad920.js";import{r as Ye}from"./Confirm.fc9e96f5.js";import{u as We}from"./erc20.e9c36ea3.js";import{r as ae}from"./Create.f5d1abad.js";import{S as ze,a as He}from"./startup.3b3d8368.js";import{u as ce}from"./startup.427454b6.js";import{u as Xe}from"./useTags.f9c969ef.js";import{F as Qe}from"./ui.e26017cf.js";const Ge={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},Je=he("circle",{cx:"12",cy:"12",r:"9",fill:"#65b400",stroke:"#dbef88","stroke-width":"6"},null,-1),Ke=[Je];function Ze(e,i){return ye(),fe("svg",Ge,Ke)}const et={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},tt=he("circle",{cx:"12",cy:"12",r:"9",fill:"#E0E0E0",stroke:"#F5F6FA","stroke-width":"6"},null,-1),at=[tt];function nt(e,i){return ye(),fe("svg",et,at)}const ot=j({name:"Deposit",props:{bountyInfo:{type:Object,required:!0}},setup(e,i){const n=S(null),y=[{t:"custom",name:"deposit",title:"Deposit",slots:{label:()=>[F(t("div",null,[r("Deposit"),t("span",{class:"n-form-item-label__asterisk"},[r("\xA0*")]),t("span",{class:"text-xs ml-4 text-color3 u-body1"},[r("Depoist "),e.bountyInfo.applicantsDepositSymbol,r(" into bounty contract which can enhance credit in order to attract much more applicants")])]))]},render(m){return t(O,{value:e.bountyInfo.deposit,"onUpdate:value":h=>e.bountyInfo.deposit=h,class:"flex-1",inputProps:{precision:8,min:0,max:f,class:"flex-1"},type:"withSelect",renderSelect:()=>t(z,{class:"text-center w-30",options:[{value:e.bountyInfo.token0_symbol,label:e.bountyInfo.token0_symbol},{value:e.bountyInfo.token1_symbol,label:e.bountyInfo.token1_symbol}],value:e.bountyInfo.applicantsDepositSymbol,"onUpdate:value":h=>e.bountyInfo.applicantsDepositSymbol=h},null)},null)}},{t:"custom",name:"agreement",title:"",render(m){return t("div",{class:"flex mt-4.5 items-center"},[t(xe,{label:"I accept that I will not be able to withdraw the deposit if I do evil.",checked:e.bountyInfo.agreement,"onUpdate:checked":h=>e.bountyInfo.agreement=h},null)])}}];return i.expose({depositForm:n}),{depositForm:n,depositFields:y}},render(){return t(J,{model:this.bountyInfo,ref:e=>this.depositForm=e,class:"deposit-form"},{default:()=>[t(ne,{fields:this.depositFields,values:this.bountyInfo},null)]})}}),st=j({name:"PayDetailPeriod",props:{bountyInfo:{type:Object,required:!0},chainInfo:{type:Object}},emits:["showLeaveTipModal"],setup(e,i){const n=S(null),y=R(()=>t(z,{class:"text-center w-30",options:Ve,value:e.bountyInfo.period.periodType,"onUpdate:value":s=>e.bountyInfo.period.periodType=s},null)),m=R(()=>({usdcTotal:e.bountyInfo.period.periodAmount*e.bountyInfo.period.token1_amount,tokenTotal:e.bountyInfo.period.periodAmount*e.bountyInfo.period.token2_amount})),h=R(()=>{var u;const s=(u=e.chainInfo)==null?void 0:u.chain_id;if(s){const b=H.findIndex(k=>k.chainId===s);if(b!==-1)return H[b].currencySymbol}return""}),w=(h.value?[...new Set(G).add(e.bountyInfo.token1_symbol).add(h.value)]:[...new Set(G).add(e.bountyInfo.token1_symbol)]).map(s=>({label:s,value:s})),p=R(()=>t(z,{class:"text-center w-30",options:w,value:e.bountyInfo.payTokenSymbol,"onUpdate:value":s=>e.bountyInfo.payTokenSymbol=s},null)),o=[{t:"custom",title:"Work time planning",name:"period",render(s){return t("div",{class:"w-full"},[t("div",{class:"flex items-center"},[t(O,{inputProps:{class:"flex-1",precision:0,min:2},value:e.bountyInfo.period.periodAmount,"onUpdate:value":u=>e.bountyInfo.period.periodAmount=u,class:"flex-1",type:"withSelect",renderSelect:()=>y.value},null),t("div",{class:"px-5 text-grey2 text-3xl invisible"},[r("+")]),t(O,{inputProps:{class:"flex-1",precision:0,min:1,max:24},value:e.bountyInfo.period.hoursPerDay,"onUpdate:value":u=>e.bountyInfo.period.hoursPerDay=u,class:"flex-1",type:"withUnit",renderUnit:()=>te("hours/Day")},null)])])}},{t:"custom",title:"Rewards (once)",name:"rewards",render(s){return t("div",{class:"flex w-full items-start"},[t(O,{class:"flex-1",type:"withSelect",value:e.bountyInfo.period.token1_amount,"onUpdate:value":u=>e.bountyInfo.period.token1_amount=u,inputProps:{precision:0,min:0,max:f,class:"flex-1",parse:u=>u===null?0:Number(u),status:m.value.usdcTotal>f?"error":void 0},renderSelect:()=>p.value},null),t("div",{class:"px-5 text-grey2 text-3xl"},[r("+")]),t("div",{class:"flex-1"},[t(O,{class:"flex-1",type:"withUnit",value:e.bountyInfo.period.token2_amount,"onUpdate:value":u=>e.bountyInfo.period.token2_amount=u,inputProps:{precision:0,min:0,max:f,class:"flex-1",parse:u=>u===null?0:Number(u),status:m.value.tokenTotal>f?"error":void 0},renderUnit:()=>te(e.bountyInfo.token2_symbol)},null),t("div",null,[!e.bountyInfo.token2_symbol&&t("div",{class:"mt-2 text-xs text-color3 col-start-3"},[r("Not setup token yet, go to")," ",t("span",{class:"cursor-pointer text-primary",onClick:()=>i.emit("showLeaveTipModal","toFinanceSetting")},[r("Finance Setting")])])])])])}},{t:"custom",title:"",class:"!grid-rows-none",name:"summary",render(){return t("div",{class:"bg-purple mt-4 w-full py-5.5 px-6"},[r("The current total rewards as")," ",t("span",{class:"text-primary"},[t("span",{class:[{"text-error":m.value.usdcTotal>f}]},[m.value.usdcTotal,r(" "),e.bountyInfo.payTokenSymbol," "]),e.bountyInfo.token2_symbol&&t("span",null,[" ",r("+")," ",t("span",{class:[{"text-error":m.value.tokenTotal>f}]},[m.value.tokenTotal,r(" "),e.bountyInfo.token2_symbol])])]),(m.value.usdcTotal>f||m.value.tokenTotal>f)&&t("span",null,[r(" , Please reduce your reward to under 10000")])])}},{t:"custom",title:"Target",name:"period.target",rules:[{required:!0,message:"Please input description and target of bounty for applicant"}],render(){return t(Le,{placeholder:"Set up description and target of bounty for applicant",class:"w-full",value:e.bountyInfo.period.target,"onUpdate:value":s=>e.bountyInfo.period.target=s},null)}}],P=de(o);return i.expose({payPeriodForm:n,payPeriodTotal:m}),{payDetailPeriodFields:o,payPeriodRules:P,payPeriodForm:n}},render(){return t(J,{class:"mt-9",model:this.bountyInfo,rules:this.payPeriodRules,ref:e=>this.payPeriodForm=e},{default:()=>[t(ne,{fields:this.payDetailPeriodFields,values:this.bountyInfo},null)]})}}),lt=j({name:"PayDetailStage",props:{bountyInfo:{type:Object,required:!0},chainInfo:{type:Object}},emits:["delStage","addStage","showLeaveTipModal"],setup(e,i){const n=S(null),y=R(()=>{const s=e.bountyInfo.stages.reduce((b,k)=>b+Number(k.token1_amount),0),u=e.bountyInfo.stages.reduce((b,k)=>b+Number(k.token2_amount),0);return{usdcTotal:s,tokenTotal:u}}),m=s=>{i.emit("delStage",s)},h=()=>{i.emit("addStage")},w=()=>{i.emit("showLeaveTipModal","toFinanceSetting")};i.expose({payStageForm:n,payStagesTotal:y});const p=R(()=>{var u;const s=(u=e.chainInfo)==null?void 0:u.chain_id;if(s){const b=H.findIndex(k=>k.chainId===s);if(b!==-1)return H[b].currencySymbol}return""}),o=(p.value?[...new Set(G).add(e.bountyInfo.token1_symbol).add(p.value)]:[...new Set(G).add(e.bountyInfo.token1_symbol)]).map(s=>({label:s,value:s})),P=R(()=>t(z,{class:"text-center w-30",options:o,value:e.bountyInfo.payTokenSymbol,"onUpdate:value":s=>e.bountyInfo.payTokenSymbol=s},null));return{payStageForm:n,payStagesTotal:y,delStage:m,addStage:h,showLeaveTipModal:w,renderSelect:P}},render(){return t(J,{model:this.bountyInfo.stages,ref:e=>this.payStageForm=e,class:"mt-7"},{default:()=>[this.bountyInfo.stages.map((e,i)=>t("div",{class:"flex mb-6 items-center"},[t("div",{class:"bg-purple rounded-sm px-4 pt-4"},[t("div",{class:"text-color1"},[r("Rewards")]),t("div",{class:"grid grid-cols-[1fr,56px,1fr]"},[t(O,{class:"flex-1",type:"withSelect",inputProps:{class:"flex-1",precision:0,min:0,max:f,parse:n=>n===null?0:Number(n),status:this.payStagesTotal.usdcTotal>f?"error":void 0},value:e.token1_amount,"onUpdate:value":n=>e.token1_amount=n,renderSelect:()=>this.renderSelect},null),t("div",{class:"px-5 text-grey2 text-3xl"},[r("+")]),t(O,{class:"flex-1",type:"withUnit",inputProps:{class:"flex-1",precision:0,min:0,max:f,parse:n=>n===null?0:Number(n),status:this.payStagesTotal.tokenTotal>f?"error":void 0,disabled:!this.bountyInfo.token2_symbol},value:e.token2_amount,"onUpdate:value":n=>e.token2_amount=n,renderUnit:()=>te(this.bountyInfo.token2_symbol)},null)]),t("div",{class:"grid grid-cols-[1fr,56px,1fr]"},[!this.bountyInfo.token2_symbol&&t("div",{class:"mt-2 text-xs text-color3 col-start-3"},[r("Not setup token yet, go to")," ",t("span",{class:"cursor-pointer text-primary",onClick:()=>this.showLeaveTipModal()},[r("Finance Setting")])])]),t(Te,{path:`${i}.terms`,rule:[{required:!0,message:"Stage decription cannot be blank",trigger:"blur"},{validator:(n,y)=>!y||y.length>12,message:"Stage decription must be 12 characters or more",trigger:"blur"}]},{default:()=>[t(Ce,{placeholder:"The applicant will get the rewards when do complete this stage",type:"textarea",rows:1,class:"-mt-1",value:e.terms,"onUpdate:value":n=>e.terms=n,maxlength:200},null)]})]),t("div",{class:["flex items-center ",{invisible:this.bountyInfo.stages.length<=1,"cursor-pointer":this.bountyInfo.stages.length>1}],onClick:()=>this.bountyInfo.stages.length>1?this.delStage(i):null},[t($e,{class:"h-5 ml-5 w-5"},null)]),t("div",{class:["flex items-center cursor-pointer",{invisible:this.bountyInfo.stages.length>4||i+1<this.bountyInfo.stages.length}],onClick:i+1===this.bountyInfo.stages.length?this.addStage:void 0},[t(qe,{class:"h-5 ml-5 w-5"},null)])])),t("div",{class:"bg-purple rounded-sm mr-20 py-5.5 px-6"},[r("The current total rewards as")," ",t("span",{class:"text-primary"},[t("span",{class:[{"text-error":this.payStagesTotal.usdcTotal>f}]},[this.payStagesTotal.usdcTotal,r(" "),this.bountyInfo.payTokenSymbol]),this.bountyInfo.token2_symbol&&t("span",null,[" ",r("+")," ",t("span",{class:[{"text-error":this.payStagesTotal.tokenTotal>f}]},[this.payStagesTotal.tokenTotal,r(" "),this.bountyInfo.token2_symbol])])]),(this.payStagesTotal.usdcTotal>f||this.payStagesTotal.tokenTotal>f)&&t("span",null,[r(" , Please reduce your reward to under 10000")])])]})}});function rt(e){return{1:[{label:"ETH",value:e},{label:"USDC",value:C[1]}],5:[{label:"GoerliETH",value:e},{label:"QT13",value:C[5]}],56:[{label:"BNB",value:e},{label:"USDC",value:C[56]}],97:[{label:"TBNB",value:e},{label:"QCTS",value:C[97]}],2814:[{label:"RSYS",value:e},{label:"SUSDC",value:C[2814]}],4002:[{label:"FTM",value:e},{label:"QCTS",value:C[4002]}],250:[{label:"FTM",value:e},{label:"USDC",value:C[250]}],43113:[{label:"AVAX",value:e},{label:"V-USDC",value:C[43113]}],43114:[{label:"AVAX",value:e},{label:"USDC",value:C[43114]}],80001:[{label:"MATIC",value:e},{label:"USDC",value:C[80001]}],137:[{label:"MATIC",value:e},{label:"USDC",value:C[137]}],57:[{label:"SYS",value:e},{label:"USDC",value:C[57]}],570:[{label:"SYS",value:e},{label:"USDC",value:C[570]}],57e3:[{label:"TSYS",value:e},{label:"USDC",value:C[57e3]}]}}const it=()=>q("1.0","ether").toString().length-1;const ut=j({name:"USteps",props:{steps:{type:Array,required:!0},current:{type:Number,default:1},classes:{type:Object}},setup(e){return()=>t("div",{class:"flex w-full u-steps"},[e.steps.map((i,n)=>{var p;const y=n+1<e.current,m=n+1>e.current,h=n+1===e.current;let w=t(Ze,null,null);return y?w=t("div",{class:"rounded-1/2 border border-primary w-6 h-6 flex items-center justify-center"},[t(Ye,{class:"text-primary"},null)]):m&&(w=t(nt,null,null)),t("div",{class:["flex",{"flex-1":n!==0}]},[n!==0&&t("div",{class:["u-splitor",{"has-pass":y||h}]},null),t("div",{class:"u-step"},[t("div",null,[w]),t("div",{class:["u-step-title",(p=e.classes)==null?void 0:p.stepTitle,{"text-primary":y||h,"text-grey3":m}]},[i.name])])])})])}}),ct=j({name:"CreateBountyForm",emits:["cancel"],setup(e,i){const n=K(),y=We(),m=pe(),h=S([{name:"Bounty"},{name:"Payment"},{name:"Deposit"}]);let w=ue();const p=S(!1),o=S(""),P=Me(),s=S(),u=S(),b=S(),k=S({chain_id:void 0,on_chain:!1}),U=rt("0x0000000000000000000000000000000000000000"),M=U[n.chainId][0].label||"ETH";console.log(U,n.chainId,899899);const A=U[n.chainId][1].label||"USDC",a=S({current:1,startup_id:void 0,title:"",expiresIn:void 0,contact:[{type:1,value:""}],discussionLink:"",applicantsSkills:[],applicantsDeposit:0,description:"",payDetailType:"stage",token0_symbol:M,token0_address:U[n.chainId][0].value||"0x0000000000000000000000000000000000000000",token1_symbol:A,token1_address:U[n.chainId][1].value||"",token2_symbol:"",payTokenSymbol:"",applicantsDepositSymbol:M,stages:[{token1_amount:0,token2_amount:0,terms:""}],period:{periodType:2,periodAmount:2,hoursPerDay:1,target:"",token1_amount:0,token2_amount:0},deposit:0,agreement:!1,on_chain:!1}).value,l=()=>{a.contact.push({type:1,value:""})},v=c=>{a.contact.splice(c,1)},oe=c=>t("div",{class:"bg-white border rounded-r-lg flex px-10 w-30 justify-center items-center"},[c]),se=()=>{a.stages.push({token1_amount:0,token2_amount:0,terms:""})},E=c=>{a.stages.splice(c,1)},Y=()=>{Z();const c=`/project/setting/${a.startup_id}`;P.push(c)},le=(c="")=>{o.value=c,p.value=!0},be=async()=>{const c="Create bounty deposit contract on blockchain.",T=a.deposit,I=a.applicantsDeposit;try{const d=a.applicantsDepositSymbol===a.token0_symbol?a.token0_address:a.token1_address;let _,x,D;if(a.applicantsDepositSymbol===a.token0_symbol){_=it(),x=q(T.toString(),_),D=q(I.toString(),_),console.log(1111111111,"main token",_,d,x,D,W(a.expiresIn).utc().valueOf()/1e3);const B=await w.createBounty(d,x,D,W(a.expiresIn).utc().valueOf()/1e3,"Create bounty deposit contract on blockchain.",`<div class="flex items-center">Bounty "<span class="max-w-20 truncate">${a.title}</span>" was created</div>`,{value:x});return console.log(222222222,B),B}else{const B=await y(d);if(_=await B.decimals(),x=q(T.toString(),_),D=q(I.toString(),_),T!==0){m.startContract(c);const V=Ee[n.chainId];console.log(V),await(await B.approve(V,x)).wait()}console.log(1111111111,"erc20 token",_,d,x,D,W(a.expiresIn).utc().valueOf()/1e3);const L=await w.createBounty(d,x,D,W(a.expiresIn).utc().valueOf()/1e3,"Create bounty deposit contract on blockchain.",`<div class="flex items-center">Bounty "<span class="max-w-20 truncate">${a.title}</span>" was created</div>`);return console.log(222222222,L),L}}catch(d){ae(d),console.error(d),m.endContract("failed",{success:!1})}return null},ve=async()=>{try{const c=await be();if(!c)return;const T=(()=>{if(a.payDetailType==="stage")return{stages:a.stages.map((d,_)=>{const x=Number(d.token1_amount),D=Number(a.token2_symbol?d.token2_amount:0);return{sort_index:_+1,token1_amount:x||0,token1_symbol:a.payTokenSymbol,token2_amount:D||0,token2_symbol:a.token2_symbol,terms:d.terms}})};{const d=Number(a.period.periodAmount),_=Number(a.period.token1_amount),x=Number(a.period.token2_amount),D=Number(a.period.hoursPerDay);return{period:{period:d||0,period_type:a.period.periodType,hours_per_day:D||0,token1_amount:_||0,token1_symbol:a.payTokenSymbol,token2_amount:x||0,token2_symbol:a.token2_symbol,terms:a.period.target}}}})(),I=a.payDetailType==="stage"?1:a.payDetailType==="period"?2:0;await X["Bounty@create-bounty"]({startup_id:a==null?void 0:a.startup_id,contacts:a.contact.filter(d=>d.value).map(d=>({type:d.type,value:d.value})),deposit_contract_token_symbol:a.applicantsDepositSymbol,description:a.description,discussion_link:a.discussionLink,payment_mode:I,skills:a.applicantsSkills,title:a.title,tx_hash:c.hash,stages:a.payDetailType==="stage"?T.stages:void 0,period:a.payDetailType==="period"?T.period:void 0}),i.emit("cancel")}catch(c){ae(c),console.error("error===>",c)}},Z=()=>{p.value=!1,i.emit("cancel")},ge=async()=>{ve()},Se=()=>{n.init(!0).then(()=>{w=ue()})};Re(()=>a.startup_id,()=>{a.startup_id&&we(a.startup_id)});const we=async c=>{var d;if(!c){a.token2_symbol="";return}const{error:T,data:I}=await X["Startup@get-startup-info"]({startup_id:c});T||(I.chain_id?(a.token2_symbol=((d=I.finance)==null?void 0:d.symbol)||"",ke(I.chain_id),k.value={chain_id:I.chain_id,on_chain:I.on_chain}):console.warn("somthing is wrong",I))},ke=async c=>{var T;n.chainId!==c&&(await n.ensureWalletConnected(),await((T=n.wallet)==null?void 0:T.switchNetwork(c))?Se():Z())},Ie=()=>{var c,T,I,d,_,x,D,B,L,V,ee,re;if(a.current===1)(T=(c=s.value)==null?void 0:c.bountyDetailForm)==null||T.validate($=>{$||(a.current+=1)});else if(a.current===2&&a.payDetailType==="stage"){if(((I=b.value)==null?void 0:I.payStagesTotal.usdcTotal)>f||((_=(d=b.value)==null?void 0:d.payStagesTotal)==null?void 0:_.tokenTotal)>f)return;(D=(x=b.value)==null?void 0:x.payStageForm)==null||D.validate($=>{$||(a.current+=1)})}else if(a.current===2&&a.payDetailType==="period"){if(((B=u.value)==null?void 0:B.payPeriodTotal.usdcTotal)>f||((V=(L=u.value)==null?void 0:L.payPeriodTotal)==null?void 0:V.tokenTotal)>f)return;(re=(ee=u.value)==null?void 0:ee.payPeriodForm)==null||re.validate($=>{$||(a.current+=1)})}},_e=()=>{a.current-=1};return i.expose({bountyInfo:a,toNext:Ie,toPreviousStep:_e,onSubmit:ge,showLeaveTipModal:le}),a.payTokenSymbol=a.payTokenSymbol||a.token1_symbol,{stepOptions:h,bountyInfo:a,modalVisibleState:p,bountyBasicInfoRef:s,payPeriodRef:u,payStageRef:b,addContact:l,delContact:v,toFinanceSetting:Y,renderUnit:oe,delStage:E,addStage:se,showLeaveTipModal:le,closeDrawer:Z,modalClickYesToWhere:o,chainInfo:k}},render(){return t(je,null,[t("div",{class:"mx-35 mb-15"},[t(ut,{steps:this.stepOptions,current:this.bountyInfo.current,classes:{stepTitle:"whitespace-nowrap"},class:"mt-4"},null)]),this.bountyInfo.current===1&&t(Ae,{bountyInfo:this.bountyInfo,chainInfo:this.chainInfo,onDelContact:this.delContact,onAddContact:this.addContact,onCloseDrawer:this.closeDrawer,ref:e=>this.bountyBasicInfoRef=e},null),this.bountyInfo.current===2&&t(De,{value:this.bountyInfo.payDetailType,"onUpdate:value":e=>this.bountyInfo.payDetailType=e,class:"mt-10"},{default:()=>[t(ie,{name:"stage"},{default:()=>[t(lt,{ref:e=>this.payStageRef=e,bountyInfo:this.bountyInfo,chainInfo:this.chainInfo,onDelStage:this.delStage,onAddStage:this.addStage,onShowLeaveTipModal:this.showLeaveTipModal},null)],tab:()=>t("div",{class:"flex items-center"},[t(Ne,{class:"mr-4"},null),r(" Stage")])}),t(ie,{name:"period"},{default:()=>[t(st,{bountyInfo:this.bountyInfo,chainInfo:this.chainInfo,ref:e=>this.payPeriodRef=e,onShowLeaveTipModal:this.showLeaveTipModal},null)],tab:()=>t("div",{class:"flex items-center"},[t(Fe,{class:"mr-4"},null),r("Period")])})]}),this.bountyInfo.current===3&&t(ot,{bountyInfo:this.bountyInfo},null),t(Pe,{show:this.modalVisibleState,"onUpdate:show":e=>this.modalVisibleState=e,maskClosable:!1},{default:()=>[t(Ue,{style:{width:"540px","--n-title-text-color":"#000"},size:"huge",closable:!0,onClose:()=>this.modalVisibleState=!1,title:"Discard the changes?"},{default:()=>[t("div",{class:"min-h-20 text-color2 u-h6"},[r("The action cannot be undone at once you click 'Yes'!")]),t("div",{class:"flex mt-4 justify-end"},[t(N,{size:"large",type:"primary",ghost:!0,class:"mr-4 w-41",onClick:()=>this.modalVisibleState=!1},{default:()=>[r("Cancel")]}),t(N,{size:"large",type:"primary",class:"w-41",onClick:this.modalClickYesToWhere==="toFinanceSetting"?this.toFinanceSetting:this.closeDrawer},{default:()=>[r("Yes")]})])]})]})])}}),Pt=j({name:"CreateBountyBlock",setup(){const e=S(),i=S(!1),n=K(),y=async()=>{await n.ensureWalletConnected(),n.isNetworkSupported?i.value=!0:(Q.warning("Please switch to the supported network to create a bounty"),n.openNetworkSwitcher())},m=()=>{i.value=!1},h=()=>{var p,o;(o=(p=e.value)==null?void 0:p.showLeaveTipModal)==null||o.call(p)};return{show:y,close:m,visible:i,footer:()=>{var p,o,P,s,u,b,k,U,M,A,g,a;return t("div",{class:"text-right pr-16 pb-4 bg-purple"},[((o=(p=e.value)==null?void 0:p.bountyInfo)==null?void 0:o.current)===1&&t(N,{class:"w-40 mr-4",type:"primary",ghost:!0,onClick:h},{default:()=>[r("Cancel")]}),((s=(P=e.value)==null?void 0:P.bountyInfo)==null?void 0:s.current)>1&&t(N,{class:"w-40 mr-4",type:"primary",ghost:!0,onClick:(u=e.value)==null?void 0:u.toPreviousStep},{default:()=>[r("Previous Step")]}),((k=(b=e.value)==null?void 0:b.bountyInfo)==null?void 0:k.current)<3&&t(N,{type:"primary",class:"w-40",onClick:(U=e.value)==null?void 0:U.toNext},{default:()=>[r("Next")]}),((A=(M=e.value)==null?void 0:M.bountyInfo)==null?void 0:A.current)===3&&t(N,{type:"primary",class:"w-40",disabled:!((g=e.value)!=null&&g.bountyInfo.agreement),onClick:(a=e.value)==null?void 0:a.onSubmit},{default:()=>[r("Submit")]})])},createBountyFormRef:e}},render(){return t(me,{style:{},title:"Create Bounty",maskClosable:!1,show:this.visible,"onUpdate:show":e=>this.visible=e},{default:()=>[this.visible&&t(ct,{ref:e=>this.createBountyFormRef=e,onCancel:this.close},null)],whiteBoard:this.footer})}}),dt=j({name:"CreateStartupForm",props:{onCancel:{type:Function}},setup(e,i){const n=K(),y=pe(),m=Xe("startup"),h={chain_id:n.chainId,switch:!0,name:"",type:void 0,mission:"",overview:"",tags:[]},w=S(),p=S(!1),o=Oe({...h});let P=ce();function s(){var g;Object.assign(o,{...h}),(g=e.onCancel)==null||g.call(e)}function u(){var g;(g=w.value)==null||g.validate(async a=>{if(!n.chainId)return console.warn("missing walletStore.chainId");if(!a){p.value=!0;const{data:l}=await X["Startup@get-startup-is-existence"]({chain_id:n.chainId,name:o.name});if(!l||l.is_exist)return Q.error("Project name already exists");try{if(o.switch){const v=await P.createStartup([o.name,o.chain_id||0,!0],"The fields of network and name will be registered to blockchain.",`Project "${o.name}" was created`);if(!v)throw new Error("fail");await y.createStartupSuccessAfter({chain_id:o.chain_id||0,switch:!1,name:o.name,type:o.type?o.type:0,mission:o.mission,overview:o.overview,tags:o.tags,txHash:v.hash||""})}else{const v=await y.createStartupSuccessAfter({chain_id:o.chain_id===void 0?0:o.chain_id,switch:!1,name:o.name,type:o.type?o.type:0,mission:o.mission,overview:o.overview,tags:o.tags,txHash:""});if(!(v!=null&&v.data))throw new Error("fail")}i.emit("success",o),Q.success("Success send transaction to the chain, please wait for the confirmation"),s(),p.value=!1}catch(v){ae(v),p.value=!1}}})}const b=()=>{n.init(!0).then(()=>{P=ce()})},k=async g=>{var a;g&&n.chainId!==g&&(await n.ensureWalletConnected(),await((a=n.wallet)==null?void 0:a.switchNetwork(g))?b():o.chain_id=n.chainId)},U=R(()=>{var g;return[{t:"select",title:"Blockchain Network",name:"chain_id",placeholder:"Select startup Blockchain Network",options:Be.map(a=>({value:a.chainId,label:a.name,logo:a.logo})),defaultValue:n.chainId,onUpdateValue:a=>k(a),renderTag:({option:a})=>F("div",{style:{display:"flex",alignItems:"center"}},[F("img",{src:a.logo,class:"w-[20px] h-[20px] mr-[12px] object-cover"}),a.label]),renderLabel:a=>F("div",{style:{display:"flex",alignItems:"center"}},[F("img",{src:a.logo,class:"w-[20px] h-[20px] mr-[12px] object-cover"}),F("div",{style:{marginLeft:"12px",padding:"4px 0"}},[F("div",null,[a.label])])]),rules:[{required:!0,validator:(a,l)=>!!l,message:"Blockchain Network cannot be blank",trigger:"blur"}]},{t:"string",title:"Name",name:"name",placeholder:"Input project name",maxlength:24,validationStatus:!0,rules:[{required:!0,validator:(a,l)=>!!l,message:"Name cannot be blank",trigger:"blur"},{validator:(a,l)=>!l||l.length>=3,message:"Name must be 3 characters or more",trigger:"blur"},{asyncValidator:(a,l,v)=>new Promise((oe,se)=>{if(!n.chainId)return v(new Error("Operation not allowed"));l?X["Startup@get-startup-is-existence"]({chain_id:n.chainId,name:l}).then(E=>{var Y;(Y=E==null?void 0:E.data)!=null&&Y.is_exist?v(new Error("Operation not allowed")):v()}).catch(()=>{v()}):v()}),message:"That name has been taken. Please choose another.",trigger:"blur"}]},{t:"switch",title:"",name:"switch",disabled:!1,defaultValue:!1,railStyle:({focused:a,checked:l})=>{const v={};return l&&(v.background="#00BFA5"),v}},{t:"select",title:"Type",name:"type",placeholder:"Select project type",renderOption:({node:a,option:l})=>F(Qe,null,{trigger:()=>a,default:()=>ze[l.label]}),options:He.map((a,l)=>({label:`${a}`,value:l+1})),rules:[{required:!0,validator:(a,l)=>!!l,message:"Type cannot be blank",trigger:"blur"}]},{t:"startupTags",required:!0,title:"Tag",name:"tags",placeholder:"Select project tag",options:(g=m.TagList.value)==null?void 0:g.map(a=>({value:a.name,label:a.name})),charLimit:20},{t:"string",title:"Mission",name:"mission",placeholder:"Input project mission",maxlength:100,rules:[{required:!0,validator:(a,l)=>!!l,message:"Mission cannot be blank",trigger:"blur"},{validator:(a,l)=>!l||l.length>12,message:"Mission must be 12 characters or more",trigger:"blur"}]},{t:"string",title:"Overview",name:"overview",placeholder:"Input overview for introducing your project",type:"textarea",maxlength:1e3,rules:[{required:!0,validator:(a,l)=>!!l,message:"Overview cannot be blank",trigger:"blur"},{validator:(a,l)=>!l||l.length>100,message:"Overview must be 100 characters or more",trigger:"blur"}],autosize:{minRows:5,maxRows:5}}]}),A={...de(U.value)};return{formRef:w,allRules:A,model:o,infoFields:U,onCancel:s,onSubmit:u,loading:p}},render(){return t(J,{ref:e=>this.formRef=e,rules:this.allRules,model:this.model},{default:()=>[t(ne,{fields:this.infoFields,values:this.model},null),t("div",{class:"flex mt-10 items-center justify-end"},[t(N,{type:"default",size:"large",class:"mr-4 w-41",onClick:this.onCancel},{default:()=>[r("Cancel")]}),t(N,{type:"primary",size:"large",class:"w-41",loading:this.loading,onClick:this.onSubmit},{default:()=>[r("Submit")]})])]})}}),Ut=j({name:"CreateStartupBlock",setup(){const e=S(!1),i=K();return{show:async()=>{await i.ensureWalletConnected(),i.isNetworkSupported?e.value=!0:(Q.warning("Please switch to the supported network to create a project"),i.openNetworkSwitcher())},close:()=>{e.value=!1},visible:e}},render(){return t(me,{title:"Create a project",maskClosable:!1,show:this.visible,"onUpdate:show":e=>this.visible=e},{default:()=>[this.visible&&t(dt,{onCancel:this.close},null)]})}});export{Ut as C,ut as U,Pt as a,rt as g};
